(this["webpackJsonptic-tac-toe-reactapp"]=this["webpackJsonptic-tac-toe-reactapp"]||[]).push([[0],{20:function(e,t,a){e.exports=a(21)},21:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a(5),s=a(6),l=a(9),i=a(7),u=a(10),c=a(0),o=a.n(c),m=a(15),h=a.n(m),d=(a(26),a(27),a(28),a(13)),p=a(11),f=a(8),_=a(12),g=a(18),y=a(17),v=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("button",{className:"square",onClick:function(){return e.props.onClick()}},o.a.createElement("span",{style:{color:"X"===this.props.value?"blue":"black"}},this.props.value))}}]),t}(o.a.Component),E=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(i.a)(t).call(this,e))).state={squares:Array(9).fill(null),next:a.props.next,nextValue:"X",user_id:a.props.user_id,player1:a.props.player1,player2:a.props.player2,user_name1:a.props.user_name1,user_name2:a.props.user_name2,isFinished:!1},a.state.user_id===a.state.player2&&a.waitForNextPlayer(),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleClick",value:function(e){var t=this.state.squares.slice();if(this.props.user_id===this.state.next&&!t[e]&&!this.state.isFinished){t[e]=this.state.nextValue,this.state.next==this.state.player1?this.setState({squares:t,next:this.state.player2,nextValue:"O"}):this.setState({squares:t,next:this.state.player1,nextValue:"X"});var a=S(t),n=w(t);if(a||n){var r=a?"Finished":"Draw",s=fetch("/game-status",{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"game_id="+this.props.game_id+"&winner="+a+"&status="+r+"&cur_state="+t[e]+"&position="+e+"&user_id="+this.props.user_id+"&next="+this.props.user_name});this.setState({isFinished:!0}),s.then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}else{fetch("/add",{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"cur_state="+t[e]+"&position="+e+"&game_id="+this.props.game_id+"&user_id="+this.props.user_id+"&next="+this.props.user_name}).then((function(e){console.log(e)})).catch((function(e){console.log(e)})),this.waitForNextPlayer()}}}},{key:"waitForNextPlayer",value:function(){var e=this,t=setInterval((function(){fetch("/whoNext?game_id="+e.props.game_id).then((function(e){return e.json()})).then((function(a){if(console.log(a),"Finished"===a.status||"Draw"===a.status){clearInterval(t);var n=e.state.squares.slice();n[a.position]=a.lastValue,e.setState({squares:n,isFinished:!0})}else if(a.next==e.props.user_id){clearInterval(t);var r=e.state.squares.slice();r[a.position]=a.lastValue,"X"==a.lastValue?e.setState({squares:r,next:a.next,nextValue:"O"}):e.setState({squares:r,next:a.next,nextValue:"X"})}else e.setState({next:a.next})})).catch((function(e){console.log(e)}))}),2e3)}},{key:"renderSquare",value:function(e){var t=this;return o.a.createElement(v,{value:this.state.squares[e],onClick:function(){return t.handleClick(e)}})}},{key:"render",value:function(){var e,t=S(this.state.squares);return e="X"==t?"Winner: "+this.state.user_name1:"O"==t?"Winner: "+this.state.user_name2:w(this.state.squares)?"Draw":"X"==this.state.nextValue?"Next player: "+this.state.user_name1:"Next player: "+this.state.user_name2,o.a.createElement("div",null,o.a.createElement("div",{className:"status"},e),o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",{className:"row-separator"},o.a.createElement("td",{className:"col-separator"},this.renderSquare(0)),o.a.createElement("td",{className:"col-separator"},this.renderSquare(1)),o.a.createElement("td",null,this.renderSquare(2))),o.a.createElement("tr",{className:"row-separator"},o.a.createElement("td",{className:"col-separator"},this.renderSquare(3)),o.a.createElement("td",{className:"col-separator"},this.renderSquare(4)),o.a.createElement("td",null,this.renderSquare(5))),o.a.createElement("tr",null,o.a.createElement("td",{className:"col-separator"},this.renderSquare(6)),o.a.createElement("td",{className:"col-separator"},this.renderSquare(7)),o.a.createElement("td",null,this.renderSquare(8))))))}}]),t}(o.a.Component),b=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"game"},o.a.createElement("div",{className:"game-board"},o.a.createElement(E,{game_id:this.props.game_id,user_id:this.props.user_id,next:this.props.next,player1:this.props.player1,player2:this.props.player2,user_name1:this.props.user_name1,user_name2:this.props.user_name2})))}}]),t}(o.a.Component),x=function(e){function t(e){var a;Object(r.a)(this,t),a=Object(l.a)(this,Object(i.a)(t).call(this,e));var n=new URLSearchParams(window.location.search);return a.state={page:1,user_id:null,user_name:null,user_name1:null,user_name2:null,game_id:n.get("gameid")||"",value:null,player1:null,player2:null,next:null},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"waitForGaneStart",value:function(e){var t=this,a=setInterval((function(){fetch("/start-response?game_id="+e).then((function(e){return e.json()})).then((function(e){console.log(e),"Started"===e.status&&(clearInterval(a),t.setState({page:2,game_id:e.gameId,user_id:e.firstPlayer,next:e.firstPlayer,player1:e.firstPlayer,player2:e.secondPlayer,user_name1:e.username1,user_name2:e.username2}))})).catch((function(e){console.log(e)}))}),2e3)}},{key:"handleClickFriend",value:function(){var e=this;if(""!=this.state.user_name){var t=this.state.game_id;this.state.game_id||(t=-1),fetch("/play-game-with-friend?username="+this.state.user_name+"&gameId="+t).then((function(e){return e.json()})).then((function(t){console.log(t),"WaitingForFriend"===t.status?(e.setState({page:4,game_id:t.gameId,user_id:t.userId,player1:t.userId,user_name1:t.username1,user_name2:t.username2}),e.waitForGaneStart(t.gameId)):"Started"===t.status?e.setState({page:2,game_id:t.gameId,user_id:t.userId,user_name1:t.username1,user_name2:t.username2,player2:t.userId}):alert("Game not found")})).catch((function(e){alert("Cloud not start game"),console.log(e)}))}}},{key:"handleClickAnonymous",value:function(){var e=this;""!==this.state.user_name&&fetch("/create-game?username="+this.state.user_name).then((function(e){return e.json()})).then((function(t){console.log(t),"Started"!=t.status?(e.setState({page:3,game_id:t.gameId,user_id:t.userId,player1:t.userId,user_name1:t.username1,user_name2:t.username2}),e.waitForGaneStart(t.gameId)):e.setState({page:2,game_id:t.gameId,user_id:t.userId,user_name1:t.username1,user_name2:t.username2,player2:t.userId})})).catch((function(e){alert("Cloud not start game"),console.log(e)}))}},{key:"handleChange",value:function(e){this.setState({user_name:e.target.value})}},{key:"handleGameIdChange",value:function(e){this.setState({game_id:e.target.value})}},{key:"render",value:function(){if(1===this.state.page)return o.a.createElement(p.a,null,o.a.createElement("div",{className:"play"},o.a.createElement(_.a,null,o.a.createElement(f.a,{md:{span:4,offset:4}},o.a.createElement("h1",null,o.a.createElement(y.a,{pill:!0,variant:"success"},"TIC TAC TOE")," "),o.a.createElement(g.a,{src:"/tic_tac_toe.gif",rounded:!0}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("label",{htmlFor:"formGroupExampleInput"},"Username"),o.a.createElement("br",null),o.a.createElement("input",{type:"text",value:this.state.user_name,onChange:this.handleChange.bind(this)}),o.a.createElement("br",null),o.a.createElement(d.a,{variant:"primary",style:{marginTop:"1em"},size:"lg",onClick:this.handleClickAnonymous.bind(this)},"Play with anonymous"),o.a.createElement(d.a,{variant:"primary",style:{marginTop:"1em"},size:"lg",onClick:this.handleClickFriend.bind(this)},"Play with friend")))));if(2===this.state.page)return o.a.createElement(p.a,null,o.a.createElement("div",{className:"play"},o.a.createElement(_.a,null,o.a.createElement(f.a,{md:{span:4,offset:4}},o.a.createElement(b,{game_id:this.state.game_id,user_id:this.state.user_id,next:this.state.next,player1:this.state.player1,player2:this.state.player2,user_name1:this.state.user_name1,user_name2:this.state.user_name2})))));if(3===this.state.page)return o.a.createElement("container",null,o.a.createElement("div",{className:"play"},o.a.createElement(f.a,{md:{span:4,offset:4}},o.a.createElement("h1",{style:{color:"blue"}},"Waiting for second player"))));if(4===this.state.page){var e=window.location.href+"?gameid="+this.state.game_id;return o.a.createElement("container",null,o.a.createElement("div",{className:"play"},o.a.createElement(f.a,{md:{span:4,offset:4}},o.a.createElement("h1",{style:{color:"blue"}},"Share this link: "+e))))}}}]),t}(o.a.Component);function S(e){for(var t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],a=0;a<t.length;a++){var r=Object(n.a)(t[a],3),s=r[0],l=r[1],i=r[2];if(e[s]&&e[s]==e[l]&&e[s]==e[i])return e[s]}return null}function w(e){for(var t=0;t<e.length;t++)if(null==e[t])return!1;return!0}h.a.render(o.a.createElement(x,null),document.getElementById("root"))},26:function(e,t,a){}},[[20,1,2]]]);
//# sourceMappingURL=main.6439a0cf.chunk.js.map